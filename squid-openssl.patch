diff --git a/debian/rules b/debian/rules
index 357889e..8d0cb36 100755
--- a/debian/rules
+++ b/debian/rules
@@ -145,7 +145,7 @@ config.status:
        --sysconfdir=$(sysconfdir) \
        --localstatedir=/var/spool/squid \
        --datadir=/usr/share/squid \
-       --with-pthreads \
+       --with-pthreads --enable-ssl \
        $(with_io) \
        $(with_netfilter) \
        $(with_arp_acl) \
diff --git a/src/ssl_support.c b/src/ssl_support.c
index b704203..e25012a 100644
--- a/src/ssl_support.c
+++ b/src/ssl_support.c
@@ -446,10 +446,12 @@ sslCreateServerContext(const char *certfile, const char *keyfile, int version, c
     ERR_clear_error();
     debug(83, 1) ("Initialising SSL.\n");
     switch (version) {
+#ifndef OPENSSL_NO_SSL2
     case 2:
        debug(83, 5) ("Using SSLv2.\n");
        method = SSLv2_server_method();
        break;
+#endif
     case 3:
        debug(83, 5) ("Using SSLv3.\n");
        method = SSLv3_server_method();
@@ -609,10 +611,12 @@ sslCreateClientContext(const char *certfile, const char *keyfile, int version, c
     ERR_clear_error();
     debug(83, 1) ("Initialising SSL.\n");
     switch (version) {
+#ifndef OPENSSL_NO_SSL2
     case 2:
        debug(83, 5) ("Using SSLv2.\n");
        method = SSLv2_client_method();
        break;
+#endif
     case 3:
        debug(83, 5) ("Using SSLv3.\n");
        method = SSLv3_client_method();
